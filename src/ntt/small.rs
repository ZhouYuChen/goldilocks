//! Generated using `cargo run --bin codegen`
use crate::Field;

/// Apply a small NTT to `values`, or return `false` if the size is not supported.
pub fn small_ntt(values: &mut [Field]) -> bool {
    match values.len() {
        ..=1 => return true,
        2 => ntt_2(values),
        4 => ntt_4(values),
        8 => ntt_8(values),
        16 => ntt_16(values),
        32 => ntt_32(values),
        64 => ntt_64(values),
        128 => ntt_128(values),
        _ => return false,
    }
    true
}

/// Size 2 NTT.
fn ntt_2(values: &mut [Field]) {
    debug_assert_eq!(values.len(), 2);
    let a0 = values[0];
    let a1 = values[1];
    let (a0, a1) = (a0 + a1, a0 - a1);
    values[0] = a0;
    values[1] = a1;
}

/// Size 4 NTT.
fn ntt_4(values: &mut [Field]) {
    debug_assert_eq!(values.len(), 4);
    let a0 = values[0];
    let a1 = values[1];
    let a2 = values[2];
    let a3 = values[3];
    let (a0, a2) = (a0 + a2, a0 - a2);
    let (a1, a3) = (a1 + a3, a1 - a3);
    let a3 = a3.mul_root_384(96);
    let (a0, a1) = (a0 + a1, a0 - a1);
    let (a2, a3) = (a2 + a3, a2 - a3);
    values[0] = a0;
    values[1] = a2;
    values[2] = a1;
    values[3] = a3;
}

/// Size 8 NTT.
fn ntt_8(values: &mut [Field]) {
    debug_assert_eq!(values.len(), 8);
    let a0 = values[0];
    let a1 = values[1];
    let a2 = values[2];
    let a3 = values[3];
    let a4 = values[4];
    let a5 = values[5];
    let a6 = values[6];
    let a7 = values[7];
    let (a0, a4) = (a0 + a4, a0 - a4);
    let (a1, a5) = (a1 + a5, a1 - a5);
    let (a2, a6) = (a2 + a6, a2 - a6);
    let (a3, a7) = (a3 + a7, a3 - a7);
    let a5 = a5.mul_root_384(48);
    let a6 = a6.mul_root_384(96);
    let a7 = a7.mul_root_384(144);
    let (a0, a2) = (a0 + a2, a0 - a2);
    let (a1, a3) = (a1 + a3, a1 - a3);
    let a3 = a3.mul_root_384(96);
    let (a0, a1) = (a0 + a1, a0 - a1);
    let (a2, a3) = (a2 + a3, a2 - a3);
    let (a4, a6) = (a4 + a6, a4 - a6);
    let (a5, a7) = (a5 + a7, a5 - a7);
    let a7 = a7.mul_root_384(96);
    let (a4, a5) = (a4 + a5, a4 - a5);
    let (a6, a7) = (a6 + a7, a6 - a7);
    values[0] = a0;
    values[1] = a4;
    values[2] = a2;
    values[3] = a6;
    values[4] = a1;
    values[5] = a5;
    values[6] = a3;
    values[7] = a7;
}

/// Size 16 NTT.
fn ntt_16(values: &mut [Field]) {
    debug_assert_eq!(values.len(), 16);
    let a0 = values[0];
    let a1 = values[1];
    let a2 = values[2];
    let a3 = values[3];
    let a4 = values[4];
    let a5 = values[5];
    let a6 = values[6];
    let a7 = values[7];
    let a8 = values[8];
    let a9 = values[9];
    let a10 = values[10];
    let a11 = values[11];
    let a12 = values[12];
    let a13 = values[13];
    let a14 = values[14];
    let a15 = values[15];
    let (a0, a8) = (a0 + a8, a0 - a8);
    let (a4, a12) = (a4 + a12, a4 - a12);
    let a12 = a12.mul_root_384(96);
    let (a0, a4) = (a0 + a4, a0 - a4);
    let (a8, a12) = (a8 + a12, a8 - a12);
    let (a1, a9) = (a1 + a9, a1 - a9);
    let (a5, a13) = (a5 + a13, a5 - a13);
    let a13 = a13.mul_root_384(96);
    let (a1, a5) = (a1 + a5, a1 - a5);
    let (a9, a13) = (a9 + a13, a9 - a13);
    let (a2, a10) = (a2 + a10, a2 - a10);
    let (a6, a14) = (a6 + a14, a6 - a14);
    let a14 = a14.mul_root_384(96);
    let (a2, a6) = (a2 + a6, a2 - a6);
    let (a10, a14) = (a10 + a14, a10 - a14);
    let (a3, a11) = (a3 + a11, a3 - a11);
    let (a7, a15) = (a7 + a15, a7 - a15);
    let a15 = a15.mul_root_384(96);
    let (a3, a7) = (a3 + a7, a3 - a7);
    let (a11, a15) = (a11 + a15, a11 - a15);
    let a9 = a9.mul_root_384(24);
    let a5 = a5.mul_root_384(48);
    let a13 = a13.mul_root_384(72);
    let a10 = a10.mul_root_384(48);
    let a6 = a6.mul_root_384(96);
    let a14 = a14.mul_root_384(144);
    let a11 = a11.mul_root_384(72);
    let a7 = a7.mul_root_384(144);
    let a15 = a15.mul_root_384(216);
    let (a0, a2) = (a0 + a2, a0 - a2);
    let (a1, a3) = (a1 + a3, a1 - a3);
    let a3 = a3.mul_root_384(96);
    let (a0, a1) = (a0 + a1, a0 - a1);
    let (a2, a3) = (a2 + a3, a2 - a3);
    let (a8, a10) = (a8 + a10, a8 - a10);
    let (a9, a11) = (a9 + a11, a9 - a11);
    let a11 = a11.mul_root_384(96);
    let (a8, a9) = (a8 + a9, a8 - a9);
    let (a10, a11) = (a10 + a11, a10 - a11);
    let (a4, a6) = (a4 + a6, a4 - a6);
    let (a5, a7) = (a5 + a7, a5 - a7);
    let a7 = a7.mul_root_384(96);
    let (a4, a5) = (a4 + a5, a4 - a5);
    let (a6, a7) = (a6 + a7, a6 - a7);
    let (a12, a14) = (a12 + a14, a12 - a14);
    let (a13, a15) = (a13 + a15, a13 - a15);
    let a15 = a15.mul_root_384(96);
    let (a12, a13) = (a12 + a13, a12 - a13);
    let (a14, a15) = (a14 + a15, a14 - a15);
    values[0] = a0;
    values[1] = a8;
    values[2] = a4;
    values[3] = a12;
    values[4] = a2;
    values[5] = a10;
    values[6] = a6;
    values[7] = a14;
    values[8] = a1;
    values[9] = a9;
    values[10] = a5;
    values[11] = a13;
    values[12] = a3;
    values[13] = a11;
    values[14] = a7;
    values[15] = a15;
}

/// Size 32 NTT.
fn ntt_32(values: &mut [Field]) {
    debug_assert_eq!(values.len(), 32);
    let a0 = values[0];
    let a1 = values[1];
    let a2 = values[2];
    let a3 = values[3];
    let a4 = values[4];
    let a5 = values[5];
    let a6 = values[6];
    let a7 = values[7];
    let a8 = values[8];
    let a9 = values[9];
    let a10 = values[10];
    let a11 = values[11];
    let a12 = values[12];
    let a13 = values[13];
    let a14 = values[14];
    let a15 = values[15];
    let a16 = values[16];
    let a17 = values[17];
    let a18 = values[18];
    let a19 = values[19];
    let a20 = values[20];
    let a21 = values[21];
    let a22 = values[22];
    let a23 = values[23];
    let a24 = values[24];
    let a25 = values[25];
    let a26 = values[26];
    let a27 = values[27];
    let a28 = values[28];
    let a29 = values[29];
    let a30 = values[30];
    let a31 = values[31];
    let (a0, a16) = (a0 + a16, a0 - a16);
    let (a8, a24) = (a8 + a24, a8 - a24);
    let a24 = a24.mul_root_384(96);
    let (a0, a8) = (a0 + a8, a0 - a8);
    let (a16, a24) = (a16 + a24, a16 - a24);
    let (a1, a17) = (a1 + a17, a1 - a17);
    let (a9, a25) = (a9 + a25, a9 - a25);
    let a25 = a25.mul_root_384(96);
    let (a1, a9) = (a1 + a9, a1 - a9);
    let (a17, a25) = (a17 + a25, a17 - a25);
    let (a2, a18) = (a2 + a18, a2 - a18);
    let (a10, a26) = (a10 + a26, a10 - a26);
    let a26 = a26.mul_root_384(96);
    let (a2, a10) = (a2 + a10, a2 - a10);
    let (a18, a26) = (a18 + a26, a18 - a26);
    let (a3, a19) = (a3 + a19, a3 - a19);
    let (a11, a27) = (a11 + a27, a11 - a27);
    let a27 = a27.mul_root_384(96);
    let (a3, a11) = (a3 + a11, a3 - a11);
    let (a19, a27) = (a19 + a27, a19 - a27);
    let (a4, a20) = (a4 + a20, a4 - a20);
    let (a12, a28) = (a12 + a28, a12 - a28);
    let a28 = a28.mul_root_384(96);
    let (a4, a12) = (a4 + a12, a4 - a12);
    let (a20, a28) = (a20 + a28, a20 - a28);
    let (a5, a21) = (a5 + a21, a5 - a21);
    let (a13, a29) = (a13 + a29, a13 - a29);
    let a29 = a29.mul_root_384(96);
    let (a5, a13) = (a5 + a13, a5 - a13);
    let (a21, a29) = (a21 + a29, a21 - a29);
    let (a6, a22) = (a6 + a22, a6 - a22);
    let (a14, a30) = (a14 + a30, a14 - a30);
    let a30 = a30.mul_root_384(96);
    let (a6, a14) = (a6 + a14, a6 - a14);
    let (a22, a30) = (a22 + a30, a22 - a30);
    let (a7, a23) = (a7 + a23, a7 - a23);
    let (a15, a31) = (a15 + a31, a15 - a31);
    let a31 = a31.mul_root_384(96);
    let (a7, a15) = (a7 + a15, a7 - a15);
    let (a23, a31) = (a23 + a31, a23 - a31);
    let a17 = a17.mul_root_384(12);
    let a9 = a9.mul_root_384(24);
    let a25 = a25.mul_root_384(36);
    let a18 = a18.mul_root_384(24);
    let a10 = a10.mul_root_384(48);
    let a26 = a26.mul_root_384(72);
    let a19 = a19.mul_root_384(36);
    let a11 = a11.mul_root_384(72);
    let a27 = a27.mul_root_384(108);
    let a20 = a20.mul_root_384(48);
    let a12 = a12.mul_root_384(96);
    let a28 = a28.mul_root_384(144);
    let a21 = a21.mul_root_384(60);
    let a13 = a13.mul_root_384(120);
    let a29 = a29.mul_root_384(180);
    let a22 = a22.mul_root_384(72);
    let a14 = a14.mul_root_384(144);
    let a30 = a30.mul_root_384(216);
    let a23 = a23.mul_root_384(84);
    let a15 = a15.mul_root_384(168);
    let a31 = a31.mul_root_384(252);
    let (a0, a4) = (a0 + a4, a0 - a4);
    let (a1, a5) = (a1 + a5, a1 - a5);
    let (a2, a6) = (a2 + a6, a2 - a6);
    let (a3, a7) = (a3 + a7, a3 - a7);
    let a5 = a5.mul_root_384(48);
    let a6 = a6.mul_root_384(96);
    let a7 = a7.mul_root_384(144);
    let (a0, a2) = (a0 + a2, a0 - a2);
    let (a1, a3) = (a1 + a3, a1 - a3);
    let a3 = a3.mul_root_384(96);
    let (a0, a1) = (a0 + a1, a0 - a1);
    let (a2, a3) = (a2 + a3, a2 - a3);
    let (a4, a6) = (a4 + a6, a4 - a6);
    let (a5, a7) = (a5 + a7, a5 - a7);
    let a7 = a7.mul_root_384(96);
    let (a4, a5) = (a4 + a5, a4 - a5);
    let (a6, a7) = (a6 + a7, a6 - a7);
    let (a16, a20) = (a16 + a20, a16 - a20);
    let (a17, a21) = (a17 + a21, a17 - a21);
    let (a18, a22) = (a18 + a22, a18 - a22);
    let (a19, a23) = (a19 + a23, a19 - a23);
    let a21 = a21.mul_root_384(48);
    let a22 = a22.mul_root_384(96);
    let a23 = a23.mul_root_384(144);
    let (a16, a18) = (a16 + a18, a16 - a18);
    let (a17, a19) = (a17 + a19, a17 - a19);
    let a19 = a19.mul_root_384(96);
    let (a16, a17) = (a16 + a17, a16 - a17);
    let (a18, a19) = (a18 + a19, a18 - a19);
    let (a20, a22) = (a20 + a22, a20 - a22);
    let (a21, a23) = (a21 + a23, a21 - a23);
    let a23 = a23.mul_root_384(96);
    let (a20, a21) = (a20 + a21, a20 - a21);
    let (a22, a23) = (a22 + a23, a22 - a23);
    let (a8, a12) = (a8 + a12, a8 - a12);
    let (a9, a13) = (a9 + a13, a9 - a13);
    let (a10, a14) = (a10 + a14, a10 - a14);
    let (a11, a15) = (a11 + a15, a11 - a15);
    let a13 = a13.mul_root_384(48);
    let a14 = a14.mul_root_384(96);
    let a15 = a15.mul_root_384(144);
    let (a8, a10) = (a8 + a10, a8 - a10);
    let (a9, a11) = (a9 + a11, a9 - a11);
    let a11 = a11.mul_root_384(96);
    let (a8, a9) = (a8 + a9, a8 - a9);
    let (a10, a11) = (a10 + a11, a10 - a11);
    let (a12, a14) = (a12 + a14, a12 - a14);
    let (a13, a15) = (a13 + a15, a13 - a15);
    let a15 = a15.mul_root_384(96);
    let (a12, a13) = (a12 + a13, a12 - a13);
    let (a14, a15) = (a14 + a15, a14 - a15);
    let (a24, a28) = (a24 + a28, a24 - a28);
    let (a25, a29) = (a25 + a29, a25 - a29);
    let (a26, a30) = (a26 + a30, a26 - a30);
    let (a27, a31) = (a27 + a31, a27 - a31);
    let a29 = a29.mul_root_384(48);
    let a30 = a30.mul_root_384(96);
    let a31 = a31.mul_root_384(144);
    let (a24, a26) = (a24 + a26, a24 - a26);
    let (a25, a27) = (a25 + a27, a25 - a27);
    let a27 = a27.mul_root_384(96);
    let (a24, a25) = (a24 + a25, a24 - a25);
    let (a26, a27) = (a26 + a27, a26 - a27);
    let (a28, a30) = (a28 + a30, a28 - a30);
    let (a29, a31) = (a29 + a31, a29 - a31);
    let a31 = a31.mul_root_384(96);
    let (a28, a29) = (a28 + a29, a28 - a29);
    let (a30, a31) = (a30 + a31, a30 - a31);
    values[0] = a0;
    values[1] = a16;
    values[2] = a8;
    values[3] = a24;
    values[4] = a4;
    values[5] = a20;
    values[6] = a12;
    values[7] = a28;
    values[8] = a2;
    values[9] = a18;
    values[10] = a10;
    values[11] = a26;
    values[12] = a6;
    values[13] = a22;
    values[14] = a14;
    values[15] = a30;
    values[16] = a1;
    values[17] = a17;
    values[18] = a9;
    values[19] = a25;
    values[20] = a5;
    values[21] = a21;
    values[22] = a13;
    values[23] = a29;
    values[24] = a3;
    values[25] = a19;
    values[26] = a11;
    values[27] = a27;
    values[28] = a7;
    values[29] = a23;
    values[30] = a15;
    values[31] = a31;
}

/// Size 64 NTT.
fn ntt_64(values: &mut [Field]) {
    debug_assert_eq!(values.len(), 64);
    let a0 = values[0];
    let a1 = values[1];
    let a2 = values[2];
    let a3 = values[3];
    let a4 = values[4];
    let a5 = values[5];
    let a6 = values[6];
    let a7 = values[7];
    let a8 = values[8];
    let a9 = values[9];
    let a10 = values[10];
    let a11 = values[11];
    let a12 = values[12];
    let a13 = values[13];
    let a14 = values[14];
    let a15 = values[15];
    let a16 = values[16];
    let a17 = values[17];
    let a18 = values[18];
    let a19 = values[19];
    let a20 = values[20];
    let a21 = values[21];
    let a22 = values[22];
    let a23 = values[23];
    let a24 = values[24];
    let a25 = values[25];
    let a26 = values[26];
    let a27 = values[27];
    let a28 = values[28];
    let a29 = values[29];
    let a30 = values[30];
    let a31 = values[31];
    let a32 = values[32];
    let a33 = values[33];
    let a34 = values[34];
    let a35 = values[35];
    let a36 = values[36];
    let a37 = values[37];
    let a38 = values[38];
    let a39 = values[39];
    let a40 = values[40];
    let a41 = values[41];
    let a42 = values[42];
    let a43 = values[43];
    let a44 = values[44];
    let a45 = values[45];
    let a46 = values[46];
    let a47 = values[47];
    let a48 = values[48];
    let a49 = values[49];
    let a50 = values[50];
    let a51 = values[51];
    let a52 = values[52];
    let a53 = values[53];
    let a54 = values[54];
    let a55 = values[55];
    let a56 = values[56];
    let a57 = values[57];
    let a58 = values[58];
    let a59 = values[59];
    let a60 = values[60];
    let a61 = values[61];
    let a62 = values[62];
    let a63 = values[63];
    let (a0, a32) = (a0 + a32, a0 - a32);
    let (a8, a40) = (a8 + a40, a8 - a40);
    let (a16, a48) = (a16 + a48, a16 - a48);
    let (a24, a56) = (a24 + a56, a24 - a56);
    let a40 = a40.mul_root_384(48);
    let a48 = a48.mul_root_384(96);
    let a56 = a56.mul_root_384(144);
    let (a0, a16) = (a0 + a16, a0 - a16);
    let (a8, a24) = (a8 + a24, a8 - a24);
    let a24 = a24.mul_root_384(96);
    let (a0, a8) = (a0 + a8, a0 - a8);
    let (a16, a24) = (a16 + a24, a16 - a24);
    let (a32, a48) = (a32 + a48, a32 - a48);
    let (a40, a56) = (a40 + a56, a40 - a56);
    let a56 = a56.mul_root_384(96);
    let (a32, a40) = (a32 + a40, a32 - a40);
    let (a48, a56) = (a48 + a56, a48 - a56);
    let (a1, a33) = (a1 + a33, a1 - a33);
    let (a9, a41) = (a9 + a41, a9 - a41);
    let (a17, a49) = (a17 + a49, a17 - a49);
    let (a25, a57) = (a25 + a57, a25 - a57);
    let a41 = a41.mul_root_384(48);
    let a49 = a49.mul_root_384(96);
    let a57 = a57.mul_root_384(144);
    let (a1, a17) = (a1 + a17, a1 - a17);
    let (a9, a25) = (a9 + a25, a9 - a25);
    let a25 = a25.mul_root_384(96);
    let (a1, a9) = (a1 + a9, a1 - a9);
    let (a17, a25) = (a17 + a25, a17 - a25);
    let (a33, a49) = (a33 + a49, a33 - a49);
    let (a41, a57) = (a41 + a57, a41 - a57);
    let a57 = a57.mul_root_384(96);
    let (a33, a41) = (a33 + a41, a33 - a41);
    let (a49, a57) = (a49 + a57, a49 - a57);
    let (a2, a34) = (a2 + a34, a2 - a34);
    let (a10, a42) = (a10 + a42, a10 - a42);
    let (a18, a50) = (a18 + a50, a18 - a50);
    let (a26, a58) = (a26 + a58, a26 - a58);
    let a42 = a42.mul_root_384(48);
    let a50 = a50.mul_root_384(96);
    let a58 = a58.mul_root_384(144);
    let (a2, a18) = (a2 + a18, a2 - a18);
    let (a10, a26) = (a10 + a26, a10 - a26);
    let a26 = a26.mul_root_384(96);
    let (a2, a10) = (a2 + a10, a2 - a10);
    let (a18, a26) = (a18 + a26, a18 - a26);
    let (a34, a50) = (a34 + a50, a34 - a50);
    let (a42, a58) = (a42 + a58, a42 - a58);
    let a58 = a58.mul_root_384(96);
    let (a34, a42) = (a34 + a42, a34 - a42);
    let (a50, a58) = (a50 + a58, a50 - a58);
    let (a3, a35) = (a3 + a35, a3 - a35);
    let (a11, a43) = (a11 + a43, a11 - a43);
    let (a19, a51) = (a19 + a51, a19 - a51);
    let (a27, a59) = (a27 + a59, a27 - a59);
    let a43 = a43.mul_root_384(48);
    let a51 = a51.mul_root_384(96);
    let a59 = a59.mul_root_384(144);
    let (a3, a19) = (a3 + a19, a3 - a19);
    let (a11, a27) = (a11 + a27, a11 - a27);
    let a27 = a27.mul_root_384(96);
    let (a3, a11) = (a3 + a11, a3 - a11);
    let (a19, a27) = (a19 + a27, a19 - a27);
    let (a35, a51) = (a35 + a51, a35 - a51);
    let (a43, a59) = (a43 + a59, a43 - a59);
    let a59 = a59.mul_root_384(96);
    let (a35, a43) = (a35 + a43, a35 - a43);
    let (a51, a59) = (a51 + a59, a51 - a59);
    let (a4, a36) = (a4 + a36, a4 - a36);
    let (a12, a44) = (a12 + a44, a12 - a44);
    let (a20, a52) = (a20 + a52, a20 - a52);
    let (a28, a60) = (a28 + a60, a28 - a60);
    let a44 = a44.mul_root_384(48);
    let a52 = a52.mul_root_384(96);
    let a60 = a60.mul_root_384(144);
    let (a4, a20) = (a4 + a20, a4 - a20);
    let (a12, a28) = (a12 + a28, a12 - a28);
    let a28 = a28.mul_root_384(96);
    let (a4, a12) = (a4 + a12, a4 - a12);
    let (a20, a28) = (a20 + a28, a20 - a28);
    let (a36, a52) = (a36 + a52, a36 - a52);
    let (a44, a60) = (a44 + a60, a44 - a60);
    let a60 = a60.mul_root_384(96);
    let (a36, a44) = (a36 + a44, a36 - a44);
    let (a52, a60) = (a52 + a60, a52 - a60);
    let (a5, a37) = (a5 + a37, a5 - a37);
    let (a13, a45) = (a13 + a45, a13 - a45);
    let (a21, a53) = (a21 + a53, a21 - a53);
    let (a29, a61) = (a29 + a61, a29 - a61);
    let a45 = a45.mul_root_384(48);
    let a53 = a53.mul_root_384(96);
    let a61 = a61.mul_root_384(144);
    let (a5, a21) = (a5 + a21, a5 - a21);
    let (a13, a29) = (a13 + a29, a13 - a29);
    let a29 = a29.mul_root_384(96);
    let (a5, a13) = (a5 + a13, a5 - a13);
    let (a21, a29) = (a21 + a29, a21 - a29);
    let (a37, a53) = (a37 + a53, a37 - a53);
    let (a45, a61) = (a45 + a61, a45 - a61);
    let a61 = a61.mul_root_384(96);
    let (a37, a45) = (a37 + a45, a37 - a45);
    let (a53, a61) = (a53 + a61, a53 - a61);
    let (a6, a38) = (a6 + a38, a6 - a38);
    let (a14, a46) = (a14 + a46, a14 - a46);
    let (a22, a54) = (a22 + a54, a22 - a54);
    let (a30, a62) = (a30 + a62, a30 - a62);
    let a46 = a46.mul_root_384(48);
    let a54 = a54.mul_root_384(96);
    let a62 = a62.mul_root_384(144);
    let (a6, a22) = (a6 + a22, a6 - a22);
    let (a14, a30) = (a14 + a30, a14 - a30);
    let a30 = a30.mul_root_384(96);
    let (a6, a14) = (a6 + a14, a6 - a14);
    let (a22, a30) = (a22 + a30, a22 - a30);
    let (a38, a54) = (a38 + a54, a38 - a54);
    let (a46, a62) = (a46 + a62, a46 - a62);
    let a62 = a62.mul_root_384(96);
    let (a38, a46) = (a38 + a46, a38 - a46);
    let (a54, a62) = (a54 + a62, a54 - a62);
    let (a7, a39) = (a7 + a39, a7 - a39);
    let (a15, a47) = (a15 + a47, a15 - a47);
    let (a23, a55) = (a23 + a55, a23 - a55);
    let (a31, a63) = (a31 + a63, a31 - a63);
    let a47 = a47.mul_root_384(48);
    let a55 = a55.mul_root_384(96);
    let a63 = a63.mul_root_384(144);
    let (a7, a23) = (a7 + a23, a7 - a23);
    let (a15, a31) = (a15 + a31, a15 - a31);
    let a31 = a31.mul_root_384(96);
    let (a7, a15) = (a7 + a15, a7 - a15);
    let (a23, a31) = (a23 + a31, a23 - a31);
    let (a39, a55) = (a39 + a55, a39 - a55);
    let (a47, a63) = (a47 + a63, a47 - a63);
    let a63 = a63.mul_root_384(96);
    let (a39, a47) = (a39 + a47, a39 - a47);
    let (a55, a63) = (a55 + a63, a55 - a63);
    let a33 = a33.mul_root_384(6);
    let a17 = a17.mul_root_384(12);
    let a49 = a49.mul_root_384(18);
    let a9 = a9.mul_root_384(24);
    let a41 = a41.mul_root_384(30);
    let a25 = a25.mul_root_384(36);
    let a57 = a57.mul_root_384(42);
    let a34 = a34.mul_root_384(12);
    let a18 = a18.mul_root_384(24);
    let a50 = a50.mul_root_384(36);
    let a10 = a10.mul_root_384(48);
    let a42 = a42.mul_root_384(60);
    let a26 = a26.mul_root_384(72);
    let a58 = a58.mul_root_384(84);
    let a35 = a35.mul_root_384(18);
    let a19 = a19.mul_root_384(36);
    let a51 = a51.mul_root_384(54);
    let a11 = a11.mul_root_384(72);
    let a43 = a43.mul_root_384(90);
    let a27 = a27.mul_root_384(108);
    let a59 = a59.mul_root_384(126);
    let a36 = a36.mul_root_384(24);
    let a20 = a20.mul_root_384(48);
    let a52 = a52.mul_root_384(72);
    let a12 = a12.mul_root_384(96);
    let a44 = a44.mul_root_384(120);
    let a28 = a28.mul_root_384(144);
    let a60 = a60.mul_root_384(168);
    let a37 = a37.mul_root_384(30);
    let a21 = a21.mul_root_384(60);
    let a53 = a53.mul_root_384(90);
    let a13 = a13.mul_root_384(120);
    let a45 = a45.mul_root_384(150);
    let a29 = a29.mul_root_384(180);
    let a61 = a61.mul_root_384(210);
    let a38 = a38.mul_root_384(36);
    let a22 = a22.mul_root_384(72);
    let a54 = a54.mul_root_384(108);
    let a14 = a14.mul_root_384(144);
    let a46 = a46.mul_root_384(180);
    let a30 = a30.mul_root_384(216);
    let a62 = a62.mul_root_384(252);
    let a39 = a39.mul_root_384(42);
    let a23 = a23.mul_root_384(84);
    let a55 = a55.mul_root_384(126);
    let a15 = a15.mul_root_384(168);
    let a47 = a47.mul_root_384(210);
    let a31 = a31.mul_root_384(252);
    let a63 = a63.mul_root_384(294);
    let (a0, a4) = (a0 + a4, a0 - a4);
    let (a1, a5) = (a1 + a5, a1 - a5);
    let (a2, a6) = (a2 + a6, a2 - a6);
    let (a3, a7) = (a3 + a7, a3 - a7);
    let a5 = a5.mul_root_384(48);
    let a6 = a6.mul_root_384(96);
    let a7 = a7.mul_root_384(144);
    let (a0, a2) = (a0 + a2, a0 - a2);
    let (a1, a3) = (a1 + a3, a1 - a3);
    let a3 = a3.mul_root_384(96);
    let (a0, a1) = (a0 + a1, a0 - a1);
    let (a2, a3) = (a2 + a3, a2 - a3);
    let (a4, a6) = (a4 + a6, a4 - a6);
    let (a5, a7) = (a5 + a7, a5 - a7);
    let a7 = a7.mul_root_384(96);
    let (a4, a5) = (a4 + a5, a4 - a5);
    let (a6, a7) = (a6 + a7, a6 - a7);
    let (a32, a36) = (a32 + a36, a32 - a36);
    let (a33, a37) = (a33 + a37, a33 - a37);
    let (a34, a38) = (a34 + a38, a34 - a38);
    let (a35, a39) = (a35 + a39, a35 - a39);
    let a37 = a37.mul_root_384(48);
    let a38 = a38.mul_root_384(96);
    let a39 = a39.mul_root_384(144);
    let (a32, a34) = (a32 + a34, a32 - a34);
    let (a33, a35) = (a33 + a35, a33 - a35);
    let a35 = a35.mul_root_384(96);
    let (a32, a33) = (a32 + a33, a32 - a33);
    let (a34, a35) = (a34 + a35, a34 - a35);
    let (a36, a38) = (a36 + a38, a36 - a38);
    let (a37, a39) = (a37 + a39, a37 - a39);
    let a39 = a39.mul_root_384(96);
    let (a36, a37) = (a36 + a37, a36 - a37);
    let (a38, a39) = (a38 + a39, a38 - a39);
    let (a16, a20) = (a16 + a20, a16 - a20);
    let (a17, a21) = (a17 + a21, a17 - a21);
    let (a18, a22) = (a18 + a22, a18 - a22);
    let (a19, a23) = (a19 + a23, a19 - a23);
    let a21 = a21.mul_root_384(48);
    let a22 = a22.mul_root_384(96);
    let a23 = a23.mul_root_384(144);
    let (a16, a18) = (a16 + a18, a16 - a18);
    let (a17, a19) = (a17 + a19, a17 - a19);
    let a19 = a19.mul_root_384(96);
    let (a16, a17) = (a16 + a17, a16 - a17);
    let (a18, a19) = (a18 + a19, a18 - a19);
    let (a20, a22) = (a20 + a22, a20 - a22);
    let (a21, a23) = (a21 + a23, a21 - a23);
    let a23 = a23.mul_root_384(96);
    let (a20, a21) = (a20 + a21, a20 - a21);
    let (a22, a23) = (a22 + a23, a22 - a23);
    let (a48, a52) = (a48 + a52, a48 - a52);
    let (a49, a53) = (a49 + a53, a49 - a53);
    let (a50, a54) = (a50 + a54, a50 - a54);
    let (a51, a55) = (a51 + a55, a51 - a55);
    let a53 = a53.mul_root_384(48);
    let a54 = a54.mul_root_384(96);
    let a55 = a55.mul_root_384(144);
    let (a48, a50) = (a48 + a50, a48 - a50);
    let (a49, a51) = (a49 + a51, a49 - a51);
    let a51 = a51.mul_root_384(96);
    let (a48, a49) = (a48 + a49, a48 - a49);
    let (a50, a51) = (a50 + a51, a50 - a51);
    let (a52, a54) = (a52 + a54, a52 - a54);
    let (a53, a55) = (a53 + a55, a53 - a55);
    let a55 = a55.mul_root_384(96);
    let (a52, a53) = (a52 + a53, a52 - a53);
    let (a54, a55) = (a54 + a55, a54 - a55);
    let (a8, a12) = (a8 + a12, a8 - a12);
    let (a9, a13) = (a9 + a13, a9 - a13);
    let (a10, a14) = (a10 + a14, a10 - a14);
    let (a11, a15) = (a11 + a15, a11 - a15);
    let a13 = a13.mul_root_384(48);
    let a14 = a14.mul_root_384(96);
    let a15 = a15.mul_root_384(144);
    let (a8, a10) = (a8 + a10, a8 - a10);
    let (a9, a11) = (a9 + a11, a9 - a11);
    let a11 = a11.mul_root_384(96);
    let (a8, a9) = (a8 + a9, a8 - a9);
    let (a10, a11) = (a10 + a11, a10 - a11);
    let (a12, a14) = (a12 + a14, a12 - a14);
    let (a13, a15) = (a13 + a15, a13 - a15);
    let a15 = a15.mul_root_384(96);
    let (a12, a13) = (a12 + a13, a12 - a13);
    let (a14, a15) = (a14 + a15, a14 - a15);
    let (a40, a44) = (a40 + a44, a40 - a44);
    let (a41, a45) = (a41 + a45, a41 - a45);
    let (a42, a46) = (a42 + a46, a42 - a46);
    let (a43, a47) = (a43 + a47, a43 - a47);
    let a45 = a45.mul_root_384(48);
    let a46 = a46.mul_root_384(96);
    let a47 = a47.mul_root_384(144);
    let (a40, a42) = (a40 + a42, a40 - a42);
    let (a41, a43) = (a41 + a43, a41 - a43);
    let a43 = a43.mul_root_384(96);
    let (a40, a41) = (a40 + a41, a40 - a41);
    let (a42, a43) = (a42 + a43, a42 - a43);
    let (a44, a46) = (a44 + a46, a44 - a46);
    let (a45, a47) = (a45 + a47, a45 - a47);
    let a47 = a47.mul_root_384(96);
    let (a44, a45) = (a44 + a45, a44 - a45);
    let (a46, a47) = (a46 + a47, a46 - a47);
    let (a24, a28) = (a24 + a28, a24 - a28);
    let (a25, a29) = (a25 + a29, a25 - a29);
    let (a26, a30) = (a26 + a30, a26 - a30);
    let (a27, a31) = (a27 + a31, a27 - a31);
    let a29 = a29.mul_root_384(48);
    let a30 = a30.mul_root_384(96);
    let a31 = a31.mul_root_384(144);
    let (a24, a26) = (a24 + a26, a24 - a26);
    let (a25, a27) = (a25 + a27, a25 - a27);
    let a27 = a27.mul_root_384(96);
    let (a24, a25) = (a24 + a25, a24 - a25);
    let (a26, a27) = (a26 + a27, a26 - a27);
    let (a28, a30) = (a28 + a30, a28 - a30);
    let (a29, a31) = (a29 + a31, a29 - a31);
    let a31 = a31.mul_root_384(96);
    let (a28, a29) = (a28 + a29, a28 - a29);
    let (a30, a31) = (a30 + a31, a30 - a31);
    let (a56, a60) = (a56 + a60, a56 - a60);
    let (a57, a61) = (a57 + a61, a57 - a61);
    let (a58, a62) = (a58 + a62, a58 - a62);
    let (a59, a63) = (a59 + a63, a59 - a63);
    let a61 = a61.mul_root_384(48);
    let a62 = a62.mul_root_384(96);
    let a63 = a63.mul_root_384(144);
    let (a56, a58) = (a56 + a58, a56 - a58);
    let (a57, a59) = (a57 + a59, a57 - a59);
    let a59 = a59.mul_root_384(96);
    let (a56, a57) = (a56 + a57, a56 - a57);
    let (a58, a59) = (a58 + a59, a58 - a59);
    let (a60, a62) = (a60 + a62, a60 - a62);
    let (a61, a63) = (a61 + a63, a61 - a63);
    let a63 = a63.mul_root_384(96);
    let (a60, a61) = (a60 + a61, a60 - a61);
    let (a62, a63) = (a62 + a63, a62 - a63);
    values[0] = a0;
    values[1] = a32;
    values[2] = a16;
    values[3] = a48;
    values[4] = a8;
    values[5] = a40;
    values[6] = a24;
    values[7] = a56;
    values[8] = a4;
    values[9] = a36;
    values[10] = a20;
    values[11] = a52;
    values[12] = a12;
    values[13] = a44;
    values[14] = a28;
    values[15] = a60;
    values[16] = a2;
    values[17] = a34;
    values[18] = a18;
    values[19] = a50;
    values[20] = a10;
    values[21] = a42;
    values[22] = a26;
    values[23] = a58;
    values[24] = a6;
    values[25] = a38;
    values[26] = a22;
    values[27] = a54;
    values[28] = a14;
    values[29] = a46;
    values[30] = a30;
    values[31] = a62;
    values[32] = a1;
    values[33] = a33;
    values[34] = a17;
    values[35] = a49;
    values[36] = a9;
    values[37] = a41;
    values[38] = a25;
    values[39] = a57;
    values[40] = a5;
    values[41] = a37;
    values[42] = a21;
    values[43] = a53;
    values[44] = a13;
    values[45] = a45;
    values[46] = a29;
    values[47] = a61;
    values[48] = a3;
    values[49] = a35;
    values[50] = a19;
    values[51] = a51;
    values[52] = a11;
    values[53] = a43;
    values[54] = a27;
    values[55] = a59;
    values[56] = a7;
    values[57] = a39;
    values[58] = a23;
    values[59] = a55;
    values[60] = a15;
    values[61] = a47;
    values[62] = a31;
    values[63] = a63;
}

/// Size 128 NTT.
fn ntt_128(values: &mut [Field]) {
    debug_assert_eq!(values.len(), 128);
    let a0 = values[0];
    let a1 = values[1];
    let a2 = values[2];
    let a3 = values[3];
    let a4 = values[4];
    let a5 = values[5];
    let a6 = values[6];
    let a7 = values[7];
    let a8 = values[8];
    let a9 = values[9];
    let a10 = values[10];
    let a11 = values[11];
    let a12 = values[12];
    let a13 = values[13];
    let a14 = values[14];
    let a15 = values[15];
    let a16 = values[16];
    let a17 = values[17];
    let a18 = values[18];
    let a19 = values[19];
    let a20 = values[20];
    let a21 = values[21];
    let a22 = values[22];
    let a23 = values[23];
    let a24 = values[24];
    let a25 = values[25];
    let a26 = values[26];
    let a27 = values[27];
    let a28 = values[28];
    let a29 = values[29];
    let a30 = values[30];
    let a31 = values[31];
    let a32 = values[32];
    let a33 = values[33];
    let a34 = values[34];
    let a35 = values[35];
    let a36 = values[36];
    let a37 = values[37];
    let a38 = values[38];
    let a39 = values[39];
    let a40 = values[40];
    let a41 = values[41];
    let a42 = values[42];
    let a43 = values[43];
    let a44 = values[44];
    let a45 = values[45];
    let a46 = values[46];
    let a47 = values[47];
    let a48 = values[48];
    let a49 = values[49];
    let a50 = values[50];
    let a51 = values[51];
    let a52 = values[52];
    let a53 = values[53];
    let a54 = values[54];
    let a55 = values[55];
    let a56 = values[56];
    let a57 = values[57];
    let a58 = values[58];
    let a59 = values[59];
    let a60 = values[60];
    let a61 = values[61];
    let a62 = values[62];
    let a63 = values[63];
    let a64 = values[64];
    let a65 = values[65];
    let a66 = values[66];
    let a67 = values[67];
    let a68 = values[68];
    let a69 = values[69];
    let a70 = values[70];
    let a71 = values[71];
    let a72 = values[72];
    let a73 = values[73];
    let a74 = values[74];
    let a75 = values[75];
    let a76 = values[76];
    let a77 = values[77];
    let a78 = values[78];
    let a79 = values[79];
    let a80 = values[80];
    let a81 = values[81];
    let a82 = values[82];
    let a83 = values[83];
    let a84 = values[84];
    let a85 = values[85];
    let a86 = values[86];
    let a87 = values[87];
    let a88 = values[88];
    let a89 = values[89];
    let a90 = values[90];
    let a91 = values[91];
    let a92 = values[92];
    let a93 = values[93];
    let a94 = values[94];
    let a95 = values[95];
    let a96 = values[96];
    let a97 = values[97];
    let a98 = values[98];
    let a99 = values[99];
    let a100 = values[100];
    let a101 = values[101];
    let a102 = values[102];
    let a103 = values[103];
    let a104 = values[104];
    let a105 = values[105];
    let a106 = values[106];
    let a107 = values[107];
    let a108 = values[108];
    let a109 = values[109];
    let a110 = values[110];
    let a111 = values[111];
    let a112 = values[112];
    let a113 = values[113];
    let a114 = values[114];
    let a115 = values[115];
    let a116 = values[116];
    let a117 = values[117];
    let a118 = values[118];
    let a119 = values[119];
    let a120 = values[120];
    let a121 = values[121];
    let a122 = values[122];
    let a123 = values[123];
    let a124 = values[124];
    let a125 = values[125];
    let a126 = values[126];
    let a127 = values[127];
    let (a0, a64) = (a0 + a64, a0 - a64);
    let (a16, a80) = (a16 + a80, a16 - a80);
    let (a32, a96) = (a32 + a96, a32 - a96);
    let (a48, a112) = (a48 + a112, a48 - a112);
    let a80 = a80.mul_root_384(48);
    let a96 = a96.mul_root_384(96);
    let a112 = a112.mul_root_384(144);
    let (a0, a32) = (a0 + a32, a0 - a32);
    let (a16, a48) = (a16 + a48, a16 - a48);
    let a48 = a48.mul_root_384(96);
    let (a0, a16) = (a0 + a16, a0 - a16);
    let (a32, a48) = (a32 + a48, a32 - a48);
    let (a64, a96) = (a64 + a96, a64 - a96);
    let (a80, a112) = (a80 + a112, a80 - a112);
    let a112 = a112.mul_root_384(96);
    let (a64, a80) = (a64 + a80, a64 - a80);
    let (a96, a112) = (a96 + a112, a96 - a112);
    let (a1, a65) = (a1 + a65, a1 - a65);
    let (a17, a81) = (a17 + a81, a17 - a81);
    let (a33, a97) = (a33 + a97, a33 - a97);
    let (a49, a113) = (a49 + a113, a49 - a113);
    let a81 = a81.mul_root_384(48);
    let a97 = a97.mul_root_384(96);
    let a113 = a113.mul_root_384(144);
    let (a1, a33) = (a1 + a33, a1 - a33);
    let (a17, a49) = (a17 + a49, a17 - a49);
    let a49 = a49.mul_root_384(96);
    let (a1, a17) = (a1 + a17, a1 - a17);
    let (a33, a49) = (a33 + a49, a33 - a49);
    let (a65, a97) = (a65 + a97, a65 - a97);
    let (a81, a113) = (a81 + a113, a81 - a113);
    let a113 = a113.mul_root_384(96);
    let (a65, a81) = (a65 + a81, a65 - a81);
    let (a97, a113) = (a97 + a113, a97 - a113);
    let (a2, a66) = (a2 + a66, a2 - a66);
    let (a18, a82) = (a18 + a82, a18 - a82);
    let (a34, a98) = (a34 + a98, a34 - a98);
    let (a50, a114) = (a50 + a114, a50 - a114);
    let a82 = a82.mul_root_384(48);
    let a98 = a98.mul_root_384(96);
    let a114 = a114.mul_root_384(144);
    let (a2, a34) = (a2 + a34, a2 - a34);
    let (a18, a50) = (a18 + a50, a18 - a50);
    let a50 = a50.mul_root_384(96);
    let (a2, a18) = (a2 + a18, a2 - a18);
    let (a34, a50) = (a34 + a50, a34 - a50);
    let (a66, a98) = (a66 + a98, a66 - a98);
    let (a82, a114) = (a82 + a114, a82 - a114);
    let a114 = a114.mul_root_384(96);
    let (a66, a82) = (a66 + a82, a66 - a82);
    let (a98, a114) = (a98 + a114, a98 - a114);
    let (a3, a67) = (a3 + a67, a3 - a67);
    let (a19, a83) = (a19 + a83, a19 - a83);
    let (a35, a99) = (a35 + a99, a35 - a99);
    let (a51, a115) = (a51 + a115, a51 - a115);
    let a83 = a83.mul_root_384(48);
    let a99 = a99.mul_root_384(96);
    let a115 = a115.mul_root_384(144);
    let (a3, a35) = (a3 + a35, a3 - a35);
    let (a19, a51) = (a19 + a51, a19 - a51);
    let a51 = a51.mul_root_384(96);
    let (a3, a19) = (a3 + a19, a3 - a19);
    let (a35, a51) = (a35 + a51, a35 - a51);
    let (a67, a99) = (a67 + a99, a67 - a99);
    let (a83, a115) = (a83 + a115, a83 - a115);
    let a115 = a115.mul_root_384(96);
    let (a67, a83) = (a67 + a83, a67 - a83);
    let (a99, a115) = (a99 + a115, a99 - a115);
    let (a4, a68) = (a4 + a68, a4 - a68);
    let (a20, a84) = (a20 + a84, a20 - a84);
    let (a36, a100) = (a36 + a100, a36 - a100);
    let (a52, a116) = (a52 + a116, a52 - a116);
    let a84 = a84.mul_root_384(48);
    let a100 = a100.mul_root_384(96);
    let a116 = a116.mul_root_384(144);
    let (a4, a36) = (a4 + a36, a4 - a36);
    let (a20, a52) = (a20 + a52, a20 - a52);
    let a52 = a52.mul_root_384(96);
    let (a4, a20) = (a4 + a20, a4 - a20);
    let (a36, a52) = (a36 + a52, a36 - a52);
    let (a68, a100) = (a68 + a100, a68 - a100);
    let (a84, a116) = (a84 + a116, a84 - a116);
    let a116 = a116.mul_root_384(96);
    let (a68, a84) = (a68 + a84, a68 - a84);
    let (a100, a116) = (a100 + a116, a100 - a116);
    let (a5, a69) = (a5 + a69, a5 - a69);
    let (a21, a85) = (a21 + a85, a21 - a85);
    let (a37, a101) = (a37 + a101, a37 - a101);
    let (a53, a117) = (a53 + a117, a53 - a117);
    let a85 = a85.mul_root_384(48);
    let a101 = a101.mul_root_384(96);
    let a117 = a117.mul_root_384(144);
    let (a5, a37) = (a5 + a37, a5 - a37);
    let (a21, a53) = (a21 + a53, a21 - a53);
    let a53 = a53.mul_root_384(96);
    let (a5, a21) = (a5 + a21, a5 - a21);
    let (a37, a53) = (a37 + a53, a37 - a53);
    let (a69, a101) = (a69 + a101, a69 - a101);
    let (a85, a117) = (a85 + a117, a85 - a117);
    let a117 = a117.mul_root_384(96);
    let (a69, a85) = (a69 + a85, a69 - a85);
    let (a101, a117) = (a101 + a117, a101 - a117);
    let (a6, a70) = (a6 + a70, a6 - a70);
    let (a22, a86) = (a22 + a86, a22 - a86);
    let (a38, a102) = (a38 + a102, a38 - a102);
    let (a54, a118) = (a54 + a118, a54 - a118);
    let a86 = a86.mul_root_384(48);
    let a102 = a102.mul_root_384(96);
    let a118 = a118.mul_root_384(144);
    let (a6, a38) = (a6 + a38, a6 - a38);
    let (a22, a54) = (a22 + a54, a22 - a54);
    let a54 = a54.mul_root_384(96);
    let (a6, a22) = (a6 + a22, a6 - a22);
    let (a38, a54) = (a38 + a54, a38 - a54);
    let (a70, a102) = (a70 + a102, a70 - a102);
    let (a86, a118) = (a86 + a118, a86 - a118);
    let a118 = a118.mul_root_384(96);
    let (a70, a86) = (a70 + a86, a70 - a86);
    let (a102, a118) = (a102 + a118, a102 - a118);
    let (a7, a71) = (a7 + a71, a7 - a71);
    let (a23, a87) = (a23 + a87, a23 - a87);
    let (a39, a103) = (a39 + a103, a39 - a103);
    let (a55, a119) = (a55 + a119, a55 - a119);
    let a87 = a87.mul_root_384(48);
    let a103 = a103.mul_root_384(96);
    let a119 = a119.mul_root_384(144);
    let (a7, a39) = (a7 + a39, a7 - a39);
    let (a23, a55) = (a23 + a55, a23 - a55);
    let a55 = a55.mul_root_384(96);
    let (a7, a23) = (a7 + a23, a7 - a23);
    let (a39, a55) = (a39 + a55, a39 - a55);
    let (a71, a103) = (a71 + a103, a71 - a103);
    let (a87, a119) = (a87 + a119, a87 - a119);
    let a119 = a119.mul_root_384(96);
    let (a71, a87) = (a71 + a87, a71 - a87);
    let (a103, a119) = (a103 + a119, a103 - a119);
    let (a8, a72) = (a8 + a72, a8 - a72);
    let (a24, a88) = (a24 + a88, a24 - a88);
    let (a40, a104) = (a40 + a104, a40 - a104);
    let (a56, a120) = (a56 + a120, a56 - a120);
    let a88 = a88.mul_root_384(48);
    let a104 = a104.mul_root_384(96);
    let a120 = a120.mul_root_384(144);
    let (a8, a40) = (a8 + a40, a8 - a40);
    let (a24, a56) = (a24 + a56, a24 - a56);
    let a56 = a56.mul_root_384(96);
    let (a8, a24) = (a8 + a24, a8 - a24);
    let (a40, a56) = (a40 + a56, a40 - a56);
    let (a72, a104) = (a72 + a104, a72 - a104);
    let (a88, a120) = (a88 + a120, a88 - a120);
    let a120 = a120.mul_root_384(96);
    let (a72, a88) = (a72 + a88, a72 - a88);
    let (a104, a120) = (a104 + a120, a104 - a120);
    let (a9, a73) = (a9 + a73, a9 - a73);
    let (a25, a89) = (a25 + a89, a25 - a89);
    let (a41, a105) = (a41 + a105, a41 - a105);
    let (a57, a121) = (a57 + a121, a57 - a121);
    let a89 = a89.mul_root_384(48);
    let a105 = a105.mul_root_384(96);
    let a121 = a121.mul_root_384(144);
    let (a9, a41) = (a9 + a41, a9 - a41);
    let (a25, a57) = (a25 + a57, a25 - a57);
    let a57 = a57.mul_root_384(96);
    let (a9, a25) = (a9 + a25, a9 - a25);
    let (a41, a57) = (a41 + a57, a41 - a57);
    let (a73, a105) = (a73 + a105, a73 - a105);
    let (a89, a121) = (a89 + a121, a89 - a121);
    let a121 = a121.mul_root_384(96);
    let (a73, a89) = (a73 + a89, a73 - a89);
    let (a105, a121) = (a105 + a121, a105 - a121);
    let (a10, a74) = (a10 + a74, a10 - a74);
    let (a26, a90) = (a26 + a90, a26 - a90);
    let (a42, a106) = (a42 + a106, a42 - a106);
    let (a58, a122) = (a58 + a122, a58 - a122);
    let a90 = a90.mul_root_384(48);
    let a106 = a106.mul_root_384(96);
    let a122 = a122.mul_root_384(144);
    let (a10, a42) = (a10 + a42, a10 - a42);
    let (a26, a58) = (a26 + a58, a26 - a58);
    let a58 = a58.mul_root_384(96);
    let (a10, a26) = (a10 + a26, a10 - a26);
    let (a42, a58) = (a42 + a58, a42 - a58);
    let (a74, a106) = (a74 + a106, a74 - a106);
    let (a90, a122) = (a90 + a122, a90 - a122);
    let a122 = a122.mul_root_384(96);
    let (a74, a90) = (a74 + a90, a74 - a90);
    let (a106, a122) = (a106 + a122, a106 - a122);
    let (a11, a75) = (a11 + a75, a11 - a75);
    let (a27, a91) = (a27 + a91, a27 - a91);
    let (a43, a107) = (a43 + a107, a43 - a107);
    let (a59, a123) = (a59 + a123, a59 - a123);
    let a91 = a91.mul_root_384(48);
    let a107 = a107.mul_root_384(96);
    let a123 = a123.mul_root_384(144);
    let (a11, a43) = (a11 + a43, a11 - a43);
    let (a27, a59) = (a27 + a59, a27 - a59);
    let a59 = a59.mul_root_384(96);
    let (a11, a27) = (a11 + a27, a11 - a27);
    let (a43, a59) = (a43 + a59, a43 - a59);
    let (a75, a107) = (a75 + a107, a75 - a107);
    let (a91, a123) = (a91 + a123, a91 - a123);
    let a123 = a123.mul_root_384(96);
    let (a75, a91) = (a75 + a91, a75 - a91);
    let (a107, a123) = (a107 + a123, a107 - a123);
    let (a12, a76) = (a12 + a76, a12 - a76);
    let (a28, a92) = (a28 + a92, a28 - a92);
    let (a44, a108) = (a44 + a108, a44 - a108);
    let (a60, a124) = (a60 + a124, a60 - a124);
    let a92 = a92.mul_root_384(48);
    let a108 = a108.mul_root_384(96);
    let a124 = a124.mul_root_384(144);
    let (a12, a44) = (a12 + a44, a12 - a44);
    let (a28, a60) = (a28 + a60, a28 - a60);
    let a60 = a60.mul_root_384(96);
    let (a12, a28) = (a12 + a28, a12 - a28);
    let (a44, a60) = (a44 + a60, a44 - a60);
    let (a76, a108) = (a76 + a108, a76 - a108);
    let (a92, a124) = (a92 + a124, a92 - a124);
    let a124 = a124.mul_root_384(96);
    let (a76, a92) = (a76 + a92, a76 - a92);
    let (a108, a124) = (a108 + a124, a108 - a124);
    let (a13, a77) = (a13 + a77, a13 - a77);
    let (a29, a93) = (a29 + a93, a29 - a93);
    let (a45, a109) = (a45 + a109, a45 - a109);
    let (a61, a125) = (a61 + a125, a61 - a125);
    let a93 = a93.mul_root_384(48);
    let a109 = a109.mul_root_384(96);
    let a125 = a125.mul_root_384(144);
    let (a13, a45) = (a13 + a45, a13 - a45);
    let (a29, a61) = (a29 + a61, a29 - a61);
    let a61 = a61.mul_root_384(96);
    let (a13, a29) = (a13 + a29, a13 - a29);
    let (a45, a61) = (a45 + a61, a45 - a61);
    let (a77, a109) = (a77 + a109, a77 - a109);
    let (a93, a125) = (a93 + a125, a93 - a125);
    let a125 = a125.mul_root_384(96);
    let (a77, a93) = (a77 + a93, a77 - a93);
    let (a109, a125) = (a109 + a125, a109 - a125);
    let (a14, a78) = (a14 + a78, a14 - a78);
    let (a30, a94) = (a30 + a94, a30 - a94);
    let (a46, a110) = (a46 + a110, a46 - a110);
    let (a62, a126) = (a62 + a126, a62 - a126);
    let a94 = a94.mul_root_384(48);
    let a110 = a110.mul_root_384(96);
    let a126 = a126.mul_root_384(144);
    let (a14, a46) = (a14 + a46, a14 - a46);
    let (a30, a62) = (a30 + a62, a30 - a62);
    let a62 = a62.mul_root_384(96);
    let (a14, a30) = (a14 + a30, a14 - a30);
    let (a46, a62) = (a46 + a62, a46 - a62);
    let (a78, a110) = (a78 + a110, a78 - a110);
    let (a94, a126) = (a94 + a126, a94 - a126);
    let a126 = a126.mul_root_384(96);
    let (a78, a94) = (a78 + a94, a78 - a94);
    let (a110, a126) = (a110 + a126, a110 - a126);
    let (a15, a79) = (a15 + a79, a15 - a79);
    let (a31, a95) = (a31 + a95, a31 - a95);
    let (a47, a111) = (a47 + a111, a47 - a111);
    let (a63, a127) = (a63 + a127, a63 - a127);
    let a95 = a95.mul_root_384(48);
    let a111 = a111.mul_root_384(96);
    let a127 = a127.mul_root_384(144);
    let (a15, a47) = (a15 + a47, a15 - a47);
    let (a31, a63) = (a31 + a63, a31 - a63);
    let a63 = a63.mul_root_384(96);
    let (a15, a31) = (a15 + a31, a15 - a31);
    let (a47, a63) = (a47 + a63, a47 - a63);
    let (a79, a111) = (a79 + a111, a79 - a111);
    let (a95, a127) = (a95 + a127, a95 - a127);
    let a127 = a127.mul_root_384(96);
    let (a79, a95) = (a79 + a95, a79 - a95);
    let (a111, a127) = (a111 + a127, a111 - a127);
    let a65 = a65.mul_root_384(3);
    let a33 = a33.mul_root_384(6);
    let a97 = a97.mul_root_384(9);
    let a17 = a17.mul_root_384(12);
    let a81 = a81.mul_root_384(15);
    let a49 = a49.mul_root_384(18);
    let a113 = a113.mul_root_384(21);
    let a66 = a66.mul_root_384(6);
    let a34 = a34.mul_root_384(12);
    let a98 = a98.mul_root_384(18);
    let a18 = a18.mul_root_384(24);
    let a82 = a82.mul_root_384(30);
    let a50 = a50.mul_root_384(36);
    let a114 = a114.mul_root_384(42);
    let a67 = a67.mul_root_384(9);
    let a35 = a35.mul_root_384(18);
    let a99 = a99.mul_root_384(27);
    let a19 = a19.mul_root_384(36);
    let a83 = a83.mul_root_384(45);
    let a51 = a51.mul_root_384(54);
    let a115 = a115.mul_root_384(63);
    let a68 = a68.mul_root_384(12);
    let a36 = a36.mul_root_384(24);
    let a100 = a100.mul_root_384(36);
    let a20 = a20.mul_root_384(48);
    let a84 = a84.mul_root_384(60);
    let a52 = a52.mul_root_384(72);
    let a116 = a116.mul_root_384(84);
    let a69 = a69.mul_root_384(15);
    let a37 = a37.mul_root_384(30);
    let a101 = a101.mul_root_384(45);
    let a21 = a21.mul_root_384(60);
    let a85 = a85.mul_root_384(75);
    let a53 = a53.mul_root_384(90);
    let a117 = a117.mul_root_384(105);
    let a70 = a70.mul_root_384(18);
    let a38 = a38.mul_root_384(36);
    let a102 = a102.mul_root_384(54);
    let a22 = a22.mul_root_384(72);
    let a86 = a86.mul_root_384(90);
    let a54 = a54.mul_root_384(108);
    let a118 = a118.mul_root_384(126);
    let a71 = a71.mul_root_384(21);
    let a39 = a39.mul_root_384(42);
    let a103 = a103.mul_root_384(63);
    let a23 = a23.mul_root_384(84);
    let a87 = a87.mul_root_384(105);
    let a55 = a55.mul_root_384(126);
    let a119 = a119.mul_root_384(147);
    let a72 = a72.mul_root_384(24);
    let a40 = a40.mul_root_384(48);
    let a104 = a104.mul_root_384(72);
    let a24 = a24.mul_root_384(96);
    let a88 = a88.mul_root_384(120);
    let a56 = a56.mul_root_384(144);
    let a120 = a120.mul_root_384(168);
    let a73 = a73.mul_root_384(27);
    let a41 = a41.mul_root_384(54);
    let a105 = a105.mul_root_384(81);
    let a25 = a25.mul_root_384(108);
    let a89 = a89.mul_root_384(135);
    let a57 = a57.mul_root_384(162);
    let a121 = a121.mul_root_384(189);
    let a74 = a74.mul_root_384(30);
    let a42 = a42.mul_root_384(60);
    let a106 = a106.mul_root_384(90);
    let a26 = a26.mul_root_384(120);
    let a90 = a90.mul_root_384(150);
    let a58 = a58.mul_root_384(180);
    let a122 = a122.mul_root_384(210);
    let a75 = a75.mul_root_384(33);
    let a43 = a43.mul_root_384(66);
    let a107 = a107.mul_root_384(99);
    let a27 = a27.mul_root_384(132);
    let a91 = a91.mul_root_384(165);
    let a59 = a59.mul_root_384(198);
    let a123 = a123.mul_root_384(231);
    let a76 = a76.mul_root_384(36);
    let a44 = a44.mul_root_384(72);
    let a108 = a108.mul_root_384(108);
    let a28 = a28.mul_root_384(144);
    let a92 = a92.mul_root_384(180);
    let a60 = a60.mul_root_384(216);
    let a124 = a124.mul_root_384(252);
    let a77 = a77.mul_root_384(39);
    let a45 = a45.mul_root_384(78);
    let a109 = a109.mul_root_384(117);
    let a29 = a29.mul_root_384(156);
    let a93 = a93.mul_root_384(195);
    let a61 = a61.mul_root_384(234);
    let a125 = a125.mul_root_384(273);
    let a78 = a78.mul_root_384(42);
    let a46 = a46.mul_root_384(84);
    let a110 = a110.mul_root_384(126);
    let a30 = a30.mul_root_384(168);
    let a94 = a94.mul_root_384(210);
    let a62 = a62.mul_root_384(252);
    let a126 = a126.mul_root_384(294);
    let a79 = a79.mul_root_384(45);
    let a47 = a47.mul_root_384(90);
    let a111 = a111.mul_root_384(135);
    let a31 = a31.mul_root_384(180);
    let a95 = a95.mul_root_384(225);
    let a63 = a63.mul_root_384(270);
    let a127 = a127.mul_root_384(315);
    let (a0, a8) = (a0 + a8, a0 - a8);
    let (a4, a12) = (a4 + a12, a4 - a12);
    let a12 = a12.mul_root_384(96);
    let (a0, a4) = (a0 + a4, a0 - a4);
    let (a8, a12) = (a8 + a12, a8 - a12);
    let (a1, a9) = (a1 + a9, a1 - a9);
    let (a5, a13) = (a5 + a13, a5 - a13);
    let a13 = a13.mul_root_384(96);
    let (a1, a5) = (a1 + a5, a1 - a5);
    let (a9, a13) = (a9 + a13, a9 - a13);
    let (a2, a10) = (a2 + a10, a2 - a10);
    let (a6, a14) = (a6 + a14, a6 - a14);
    let a14 = a14.mul_root_384(96);
    let (a2, a6) = (a2 + a6, a2 - a6);
    let (a10, a14) = (a10 + a14, a10 - a14);
    let (a3, a11) = (a3 + a11, a3 - a11);
    let (a7, a15) = (a7 + a15, a7 - a15);
    let a15 = a15.mul_root_384(96);
    let (a3, a7) = (a3 + a7, a3 - a7);
    let (a11, a15) = (a11 + a15, a11 - a15);
    let a9 = a9.mul_root_384(24);
    let a5 = a5.mul_root_384(48);
    let a13 = a13.mul_root_384(72);
    let a10 = a10.mul_root_384(48);
    let a6 = a6.mul_root_384(96);
    let a14 = a14.mul_root_384(144);
    let a11 = a11.mul_root_384(72);
    let a7 = a7.mul_root_384(144);
    let a15 = a15.mul_root_384(216);
    let (a0, a2) = (a0 + a2, a0 - a2);
    let (a1, a3) = (a1 + a3, a1 - a3);
    let a3 = a3.mul_root_384(96);
    let (a0, a1) = (a0 + a1, a0 - a1);
    let (a2, a3) = (a2 + a3, a2 - a3);
    let (a8, a10) = (a8 + a10, a8 - a10);
    let (a9, a11) = (a9 + a11, a9 - a11);
    let a11 = a11.mul_root_384(96);
    let (a8, a9) = (a8 + a9, a8 - a9);
    let (a10, a11) = (a10 + a11, a10 - a11);
    let (a4, a6) = (a4 + a6, a4 - a6);
    let (a5, a7) = (a5 + a7, a5 - a7);
    let a7 = a7.mul_root_384(96);
    let (a4, a5) = (a4 + a5, a4 - a5);
    let (a6, a7) = (a6 + a7, a6 - a7);
    let (a12, a14) = (a12 + a14, a12 - a14);
    let (a13, a15) = (a13 + a15, a13 - a15);
    let a15 = a15.mul_root_384(96);
    let (a12, a13) = (a12 + a13, a12 - a13);
    let (a14, a15) = (a14 + a15, a14 - a15);
    let (a64, a72) = (a64 + a72, a64 - a72);
    let (a68, a76) = (a68 + a76, a68 - a76);
    let a76 = a76.mul_root_384(96);
    let (a64, a68) = (a64 + a68, a64 - a68);
    let (a72, a76) = (a72 + a76, a72 - a76);
    let (a65, a73) = (a65 + a73, a65 - a73);
    let (a69, a77) = (a69 + a77, a69 - a77);
    let a77 = a77.mul_root_384(96);
    let (a65, a69) = (a65 + a69, a65 - a69);
    let (a73, a77) = (a73 + a77, a73 - a77);
    let (a66, a74) = (a66 + a74, a66 - a74);
    let (a70, a78) = (a70 + a78, a70 - a78);
    let a78 = a78.mul_root_384(96);
    let (a66, a70) = (a66 + a70, a66 - a70);
    let (a74, a78) = (a74 + a78, a74 - a78);
    let (a67, a75) = (a67 + a75, a67 - a75);
    let (a71, a79) = (a71 + a79, a71 - a79);
    let a79 = a79.mul_root_384(96);
    let (a67, a71) = (a67 + a71, a67 - a71);
    let (a75, a79) = (a75 + a79, a75 - a79);
    let a73 = a73.mul_root_384(24);
    let a69 = a69.mul_root_384(48);
    let a77 = a77.mul_root_384(72);
    let a74 = a74.mul_root_384(48);
    let a70 = a70.mul_root_384(96);
    let a78 = a78.mul_root_384(144);
    let a75 = a75.mul_root_384(72);
    let a71 = a71.mul_root_384(144);
    let a79 = a79.mul_root_384(216);
    let (a64, a66) = (a64 + a66, a64 - a66);
    let (a65, a67) = (a65 + a67, a65 - a67);
    let a67 = a67.mul_root_384(96);
    let (a64, a65) = (a64 + a65, a64 - a65);
    let (a66, a67) = (a66 + a67, a66 - a67);
    let (a72, a74) = (a72 + a74, a72 - a74);
    let (a73, a75) = (a73 + a75, a73 - a75);
    let a75 = a75.mul_root_384(96);
    let (a72, a73) = (a72 + a73, a72 - a73);
    let (a74, a75) = (a74 + a75, a74 - a75);
    let (a68, a70) = (a68 + a70, a68 - a70);
    let (a69, a71) = (a69 + a71, a69 - a71);
    let a71 = a71.mul_root_384(96);
    let (a68, a69) = (a68 + a69, a68 - a69);
    let (a70, a71) = (a70 + a71, a70 - a71);
    let (a76, a78) = (a76 + a78, a76 - a78);
    let (a77, a79) = (a77 + a79, a77 - a79);
    let a79 = a79.mul_root_384(96);
    let (a76, a77) = (a76 + a77, a76 - a77);
    let (a78, a79) = (a78 + a79, a78 - a79);
    let (a32, a40) = (a32 + a40, a32 - a40);
    let (a36, a44) = (a36 + a44, a36 - a44);
    let a44 = a44.mul_root_384(96);
    let (a32, a36) = (a32 + a36, a32 - a36);
    let (a40, a44) = (a40 + a44, a40 - a44);
    let (a33, a41) = (a33 + a41, a33 - a41);
    let (a37, a45) = (a37 + a45, a37 - a45);
    let a45 = a45.mul_root_384(96);
    let (a33, a37) = (a33 + a37, a33 - a37);
    let (a41, a45) = (a41 + a45, a41 - a45);
    let (a34, a42) = (a34 + a42, a34 - a42);
    let (a38, a46) = (a38 + a46, a38 - a46);
    let a46 = a46.mul_root_384(96);
    let (a34, a38) = (a34 + a38, a34 - a38);
    let (a42, a46) = (a42 + a46, a42 - a46);
    let (a35, a43) = (a35 + a43, a35 - a43);
    let (a39, a47) = (a39 + a47, a39 - a47);
    let a47 = a47.mul_root_384(96);
    let (a35, a39) = (a35 + a39, a35 - a39);
    let (a43, a47) = (a43 + a47, a43 - a47);
    let a41 = a41.mul_root_384(24);
    let a37 = a37.mul_root_384(48);
    let a45 = a45.mul_root_384(72);
    let a42 = a42.mul_root_384(48);
    let a38 = a38.mul_root_384(96);
    let a46 = a46.mul_root_384(144);
    let a43 = a43.mul_root_384(72);
    let a39 = a39.mul_root_384(144);
    let a47 = a47.mul_root_384(216);
    let (a32, a34) = (a32 + a34, a32 - a34);
    let (a33, a35) = (a33 + a35, a33 - a35);
    let a35 = a35.mul_root_384(96);
    let (a32, a33) = (a32 + a33, a32 - a33);
    let (a34, a35) = (a34 + a35, a34 - a35);
    let (a40, a42) = (a40 + a42, a40 - a42);
    let (a41, a43) = (a41 + a43, a41 - a43);
    let a43 = a43.mul_root_384(96);
    let (a40, a41) = (a40 + a41, a40 - a41);
    let (a42, a43) = (a42 + a43, a42 - a43);
    let (a36, a38) = (a36 + a38, a36 - a38);
    let (a37, a39) = (a37 + a39, a37 - a39);
    let a39 = a39.mul_root_384(96);
    let (a36, a37) = (a36 + a37, a36 - a37);
    let (a38, a39) = (a38 + a39, a38 - a39);
    let (a44, a46) = (a44 + a46, a44 - a46);
    let (a45, a47) = (a45 + a47, a45 - a47);
    let a47 = a47.mul_root_384(96);
    let (a44, a45) = (a44 + a45, a44 - a45);
    let (a46, a47) = (a46 + a47, a46 - a47);
    let (a96, a104) = (a96 + a104, a96 - a104);
    let (a100, a108) = (a100 + a108, a100 - a108);
    let a108 = a108.mul_root_384(96);
    let (a96, a100) = (a96 + a100, a96 - a100);
    let (a104, a108) = (a104 + a108, a104 - a108);
    let (a97, a105) = (a97 + a105, a97 - a105);
    let (a101, a109) = (a101 + a109, a101 - a109);
    let a109 = a109.mul_root_384(96);
    let (a97, a101) = (a97 + a101, a97 - a101);
    let (a105, a109) = (a105 + a109, a105 - a109);
    let (a98, a106) = (a98 + a106, a98 - a106);
    let (a102, a110) = (a102 + a110, a102 - a110);
    let a110 = a110.mul_root_384(96);
    let (a98, a102) = (a98 + a102, a98 - a102);
    let (a106, a110) = (a106 + a110, a106 - a110);
    let (a99, a107) = (a99 + a107, a99 - a107);
    let (a103, a111) = (a103 + a111, a103 - a111);
    let a111 = a111.mul_root_384(96);
    let (a99, a103) = (a99 + a103, a99 - a103);
    let (a107, a111) = (a107 + a111, a107 - a111);
    let a105 = a105.mul_root_384(24);
    let a101 = a101.mul_root_384(48);
    let a109 = a109.mul_root_384(72);
    let a106 = a106.mul_root_384(48);
    let a102 = a102.mul_root_384(96);
    let a110 = a110.mul_root_384(144);
    let a107 = a107.mul_root_384(72);
    let a103 = a103.mul_root_384(144);
    let a111 = a111.mul_root_384(216);
    let (a96, a98) = (a96 + a98, a96 - a98);
    let (a97, a99) = (a97 + a99, a97 - a99);
    let a99 = a99.mul_root_384(96);
    let (a96, a97) = (a96 + a97, a96 - a97);
    let (a98, a99) = (a98 + a99, a98 - a99);
    let (a104, a106) = (a104 + a106, a104 - a106);
    let (a105, a107) = (a105 + a107, a105 - a107);
    let a107 = a107.mul_root_384(96);
    let (a104, a105) = (a104 + a105, a104 - a105);
    let (a106, a107) = (a106 + a107, a106 - a107);
    let (a100, a102) = (a100 + a102, a100 - a102);
    let (a101, a103) = (a101 + a103, a101 - a103);
    let a103 = a103.mul_root_384(96);
    let (a100, a101) = (a100 + a101, a100 - a101);
    let (a102, a103) = (a102 + a103, a102 - a103);
    let (a108, a110) = (a108 + a110, a108 - a110);
    let (a109, a111) = (a109 + a111, a109 - a111);
    let a111 = a111.mul_root_384(96);
    let (a108, a109) = (a108 + a109, a108 - a109);
    let (a110, a111) = (a110 + a111, a110 - a111);
    let (a16, a24) = (a16 + a24, a16 - a24);
    let (a20, a28) = (a20 + a28, a20 - a28);
    let a28 = a28.mul_root_384(96);
    let (a16, a20) = (a16 + a20, a16 - a20);
    let (a24, a28) = (a24 + a28, a24 - a28);
    let (a17, a25) = (a17 + a25, a17 - a25);
    let (a21, a29) = (a21 + a29, a21 - a29);
    let a29 = a29.mul_root_384(96);
    let (a17, a21) = (a17 + a21, a17 - a21);
    let (a25, a29) = (a25 + a29, a25 - a29);
    let (a18, a26) = (a18 + a26, a18 - a26);
    let (a22, a30) = (a22 + a30, a22 - a30);
    let a30 = a30.mul_root_384(96);
    let (a18, a22) = (a18 + a22, a18 - a22);
    let (a26, a30) = (a26 + a30, a26 - a30);
    let (a19, a27) = (a19 + a27, a19 - a27);
    let (a23, a31) = (a23 + a31, a23 - a31);
    let a31 = a31.mul_root_384(96);
    let (a19, a23) = (a19 + a23, a19 - a23);
    let (a27, a31) = (a27 + a31, a27 - a31);
    let a25 = a25.mul_root_384(24);
    let a21 = a21.mul_root_384(48);
    let a29 = a29.mul_root_384(72);
    let a26 = a26.mul_root_384(48);
    let a22 = a22.mul_root_384(96);
    let a30 = a30.mul_root_384(144);
    let a27 = a27.mul_root_384(72);
    let a23 = a23.mul_root_384(144);
    let a31 = a31.mul_root_384(216);
    let (a16, a18) = (a16 + a18, a16 - a18);
    let (a17, a19) = (a17 + a19, a17 - a19);
    let a19 = a19.mul_root_384(96);
    let (a16, a17) = (a16 + a17, a16 - a17);
    let (a18, a19) = (a18 + a19, a18 - a19);
    let (a24, a26) = (a24 + a26, a24 - a26);
    let (a25, a27) = (a25 + a27, a25 - a27);
    let a27 = a27.mul_root_384(96);
    let (a24, a25) = (a24 + a25, a24 - a25);
    let (a26, a27) = (a26 + a27, a26 - a27);
    let (a20, a22) = (a20 + a22, a20 - a22);
    let (a21, a23) = (a21 + a23, a21 - a23);
    let a23 = a23.mul_root_384(96);
    let (a20, a21) = (a20 + a21, a20 - a21);
    let (a22, a23) = (a22 + a23, a22 - a23);
    let (a28, a30) = (a28 + a30, a28 - a30);
    let (a29, a31) = (a29 + a31, a29 - a31);
    let a31 = a31.mul_root_384(96);
    let (a28, a29) = (a28 + a29, a28 - a29);
    let (a30, a31) = (a30 + a31, a30 - a31);
    let (a80, a88) = (a80 + a88, a80 - a88);
    let (a84, a92) = (a84 + a92, a84 - a92);
    let a92 = a92.mul_root_384(96);
    let (a80, a84) = (a80 + a84, a80 - a84);
    let (a88, a92) = (a88 + a92, a88 - a92);
    let (a81, a89) = (a81 + a89, a81 - a89);
    let (a85, a93) = (a85 + a93, a85 - a93);
    let a93 = a93.mul_root_384(96);
    let (a81, a85) = (a81 + a85, a81 - a85);
    let (a89, a93) = (a89 + a93, a89 - a93);
    let (a82, a90) = (a82 + a90, a82 - a90);
    let (a86, a94) = (a86 + a94, a86 - a94);
    let a94 = a94.mul_root_384(96);
    let (a82, a86) = (a82 + a86, a82 - a86);
    let (a90, a94) = (a90 + a94, a90 - a94);
    let (a83, a91) = (a83 + a91, a83 - a91);
    let (a87, a95) = (a87 + a95, a87 - a95);
    let a95 = a95.mul_root_384(96);
    let (a83, a87) = (a83 + a87, a83 - a87);
    let (a91, a95) = (a91 + a95, a91 - a95);
    let a89 = a89.mul_root_384(24);
    let a85 = a85.mul_root_384(48);
    let a93 = a93.mul_root_384(72);
    let a90 = a90.mul_root_384(48);
    let a86 = a86.mul_root_384(96);
    let a94 = a94.mul_root_384(144);
    let a91 = a91.mul_root_384(72);
    let a87 = a87.mul_root_384(144);
    let a95 = a95.mul_root_384(216);
    let (a80, a82) = (a80 + a82, a80 - a82);
    let (a81, a83) = (a81 + a83, a81 - a83);
    let a83 = a83.mul_root_384(96);
    let (a80, a81) = (a80 + a81, a80 - a81);
    let (a82, a83) = (a82 + a83, a82 - a83);
    let (a88, a90) = (a88 + a90, a88 - a90);
    let (a89, a91) = (a89 + a91, a89 - a91);
    let a91 = a91.mul_root_384(96);
    let (a88, a89) = (a88 + a89, a88 - a89);
    let (a90, a91) = (a90 + a91, a90 - a91);
    let (a84, a86) = (a84 + a86, a84 - a86);
    let (a85, a87) = (a85 + a87, a85 - a87);
    let a87 = a87.mul_root_384(96);
    let (a84, a85) = (a84 + a85, a84 - a85);
    let (a86, a87) = (a86 + a87, a86 - a87);
    let (a92, a94) = (a92 + a94, a92 - a94);
    let (a93, a95) = (a93 + a95, a93 - a95);
    let a95 = a95.mul_root_384(96);
    let (a92, a93) = (a92 + a93, a92 - a93);
    let (a94, a95) = (a94 + a95, a94 - a95);
    let (a48, a56) = (a48 + a56, a48 - a56);
    let (a52, a60) = (a52 + a60, a52 - a60);
    let a60 = a60.mul_root_384(96);
    let (a48, a52) = (a48 + a52, a48 - a52);
    let (a56, a60) = (a56 + a60, a56 - a60);
    let (a49, a57) = (a49 + a57, a49 - a57);
    let (a53, a61) = (a53 + a61, a53 - a61);
    let a61 = a61.mul_root_384(96);
    let (a49, a53) = (a49 + a53, a49 - a53);
    let (a57, a61) = (a57 + a61, a57 - a61);
    let (a50, a58) = (a50 + a58, a50 - a58);
    let (a54, a62) = (a54 + a62, a54 - a62);
    let a62 = a62.mul_root_384(96);
    let (a50, a54) = (a50 + a54, a50 - a54);
    let (a58, a62) = (a58 + a62, a58 - a62);
    let (a51, a59) = (a51 + a59, a51 - a59);
    let (a55, a63) = (a55 + a63, a55 - a63);
    let a63 = a63.mul_root_384(96);
    let (a51, a55) = (a51 + a55, a51 - a55);
    let (a59, a63) = (a59 + a63, a59 - a63);
    let a57 = a57.mul_root_384(24);
    let a53 = a53.mul_root_384(48);
    let a61 = a61.mul_root_384(72);
    let a58 = a58.mul_root_384(48);
    let a54 = a54.mul_root_384(96);
    let a62 = a62.mul_root_384(144);
    let a59 = a59.mul_root_384(72);
    let a55 = a55.mul_root_384(144);
    let a63 = a63.mul_root_384(216);
    let (a48, a50) = (a48 + a50, a48 - a50);
    let (a49, a51) = (a49 + a51, a49 - a51);
    let a51 = a51.mul_root_384(96);
    let (a48, a49) = (a48 + a49, a48 - a49);
    let (a50, a51) = (a50 + a51, a50 - a51);
    let (a56, a58) = (a56 + a58, a56 - a58);
    let (a57, a59) = (a57 + a59, a57 - a59);
    let a59 = a59.mul_root_384(96);
    let (a56, a57) = (a56 + a57, a56 - a57);
    let (a58, a59) = (a58 + a59, a58 - a59);
    let (a52, a54) = (a52 + a54, a52 - a54);
    let (a53, a55) = (a53 + a55, a53 - a55);
    let a55 = a55.mul_root_384(96);
    let (a52, a53) = (a52 + a53, a52 - a53);
    let (a54, a55) = (a54 + a55, a54 - a55);
    let (a60, a62) = (a60 + a62, a60 - a62);
    let (a61, a63) = (a61 + a63, a61 - a63);
    let a63 = a63.mul_root_384(96);
    let (a60, a61) = (a60 + a61, a60 - a61);
    let (a62, a63) = (a62 + a63, a62 - a63);
    let (a112, a120) = (a112 + a120, a112 - a120);
    let (a116, a124) = (a116 + a124, a116 - a124);
    let a124 = a124.mul_root_384(96);
    let (a112, a116) = (a112 + a116, a112 - a116);
    let (a120, a124) = (a120 + a124, a120 - a124);
    let (a113, a121) = (a113 + a121, a113 - a121);
    let (a117, a125) = (a117 + a125, a117 - a125);
    let a125 = a125.mul_root_384(96);
    let (a113, a117) = (a113 + a117, a113 - a117);
    let (a121, a125) = (a121 + a125, a121 - a125);
    let (a114, a122) = (a114 + a122, a114 - a122);
    let (a118, a126) = (a118 + a126, a118 - a126);
    let a126 = a126.mul_root_384(96);
    let (a114, a118) = (a114 + a118, a114 - a118);
    let (a122, a126) = (a122 + a126, a122 - a126);
    let (a115, a123) = (a115 + a123, a115 - a123);
    let (a119, a127) = (a119 + a127, a119 - a127);
    let a127 = a127.mul_root_384(96);
    let (a115, a119) = (a115 + a119, a115 - a119);
    let (a123, a127) = (a123 + a127, a123 - a127);
    let a121 = a121.mul_root_384(24);
    let a117 = a117.mul_root_384(48);
    let a125 = a125.mul_root_384(72);
    let a122 = a122.mul_root_384(48);
    let a118 = a118.mul_root_384(96);
    let a126 = a126.mul_root_384(144);
    let a123 = a123.mul_root_384(72);
    let a119 = a119.mul_root_384(144);
    let a127 = a127.mul_root_384(216);
    let (a112, a114) = (a112 + a114, a112 - a114);
    let (a113, a115) = (a113 + a115, a113 - a115);
    let a115 = a115.mul_root_384(96);
    let (a112, a113) = (a112 + a113, a112 - a113);
    let (a114, a115) = (a114 + a115, a114 - a115);
    let (a120, a122) = (a120 + a122, a120 - a122);
    let (a121, a123) = (a121 + a123, a121 - a123);
    let a123 = a123.mul_root_384(96);
    let (a120, a121) = (a120 + a121, a120 - a121);
    let (a122, a123) = (a122 + a123, a122 - a123);
    let (a116, a118) = (a116 + a118, a116 - a118);
    let (a117, a119) = (a117 + a119, a117 - a119);
    let a119 = a119.mul_root_384(96);
    let (a116, a117) = (a116 + a117, a116 - a117);
    let (a118, a119) = (a118 + a119, a118 - a119);
    let (a124, a126) = (a124 + a126, a124 - a126);
    let (a125, a127) = (a125 + a127, a125 - a127);
    let a127 = a127.mul_root_384(96);
    let (a124, a125) = (a124 + a125, a124 - a125);
    let (a126, a127) = (a126 + a127, a126 - a127);
    values[0] = a0;
    values[1] = a64;
    values[2] = a32;
    values[3] = a96;
    values[4] = a16;
    values[5] = a80;
    values[6] = a48;
    values[7] = a112;
    values[8] = a8;
    values[9] = a72;
    values[10] = a40;
    values[11] = a104;
    values[12] = a24;
    values[13] = a88;
    values[14] = a56;
    values[15] = a120;
    values[16] = a4;
    values[17] = a68;
    values[18] = a36;
    values[19] = a100;
    values[20] = a20;
    values[21] = a84;
    values[22] = a52;
    values[23] = a116;
    values[24] = a12;
    values[25] = a76;
    values[26] = a44;
    values[27] = a108;
    values[28] = a28;
    values[29] = a92;
    values[30] = a60;
    values[31] = a124;
    values[32] = a2;
    values[33] = a66;
    values[34] = a34;
    values[35] = a98;
    values[36] = a18;
    values[37] = a82;
    values[38] = a50;
    values[39] = a114;
    values[40] = a10;
    values[41] = a74;
    values[42] = a42;
    values[43] = a106;
    values[44] = a26;
    values[45] = a90;
    values[46] = a58;
    values[47] = a122;
    values[48] = a6;
    values[49] = a70;
    values[50] = a38;
    values[51] = a102;
    values[52] = a22;
    values[53] = a86;
    values[54] = a54;
    values[55] = a118;
    values[56] = a14;
    values[57] = a78;
    values[58] = a46;
    values[59] = a110;
    values[60] = a30;
    values[61] = a94;
    values[62] = a62;
    values[63] = a126;
    values[64] = a1;
    values[65] = a65;
    values[66] = a33;
    values[67] = a97;
    values[68] = a17;
    values[69] = a81;
    values[70] = a49;
    values[71] = a113;
    values[72] = a9;
    values[73] = a73;
    values[74] = a41;
    values[75] = a105;
    values[76] = a25;
    values[77] = a89;
    values[78] = a57;
    values[79] = a121;
    values[80] = a5;
    values[81] = a69;
    values[82] = a37;
    values[83] = a101;
    values[84] = a21;
    values[85] = a85;
    values[86] = a53;
    values[87] = a117;
    values[88] = a13;
    values[89] = a77;
    values[90] = a45;
    values[91] = a109;
    values[92] = a29;
    values[93] = a93;
    values[94] = a61;
    values[95] = a125;
    values[96] = a3;
    values[97] = a67;
    values[98] = a35;
    values[99] = a99;
    values[100] = a19;
    values[101] = a83;
    values[102] = a51;
    values[103] = a115;
    values[104] = a11;
    values[105] = a75;
    values[106] = a43;
    values[107] = a107;
    values[108] = a27;
    values[109] = a91;
    values[110] = a59;
    values[111] = a123;
    values[112] = a7;
    values[113] = a71;
    values[114] = a39;
    values[115] = a103;
    values[116] = a23;
    values[117] = a87;
    values[118] = a55;
    values[119] = a119;
    values[120] = a15;
    values[121] = a79;
    values[122] = a47;
    values[123] = a111;
    values[124] = a31;
    values[125] = a95;
    values[126] = a63;
    values[127] = a127;
}

#[cfg(test)]
mod tests {
    use super::{super::ntt_naive, *};

    #[test]
    fn test_small_ntt() {
        for size in [0, 1, 2, 4, 8, 16, 32, 64, 128] {
            let input = (0..size).map(Field::from).collect::<Vec<_>>();
            let mut output = input.clone();
            let supported = small_ntt(output.as_mut_slice());
            assert!(supported);
            let mut output_ref = input;
            ntt_naive(output_ref.as_mut_slice());
            assert_eq!(output, output_ref);
        }
    }


    #[test]
    fn test_ntt_2() {
        let size = 2;
        let input = (0..size).map(Field::from).collect::<Vec<_>>();
        let mut output = input.clone();
        ntt_2(output.as_mut_slice());
        let mut output_ref = input;
        ntt_naive(output_ref.as_mut_slice());
        assert_eq!(output, output_ref);
    }


    #[test]
    fn test_ntt_4() {
        let size = 4;
        let input = (0..size).map(Field::from).collect::<Vec<_>>();
        let mut output = input.clone();
        ntt_4(output.as_mut_slice());
        let mut output_ref = input;
        ntt_naive(output_ref.as_mut_slice());
        assert_eq!(output, output_ref);
    }


    #[test]
    fn test_ntt_8() {
        let size = 8;
        let input = (0..size).map(Field::from).collect::<Vec<_>>();
        let mut output = input.clone();
        ntt_8(output.as_mut_slice());
        let mut output_ref = input;
        ntt_naive(output_ref.as_mut_slice());
        assert_eq!(output, output_ref);
    }


    #[test]
    fn test_ntt_16() {
        let size = 16;
        let input = (0..size).map(Field::from).collect::<Vec<_>>();
        let mut output = input.clone();
        ntt_16(output.as_mut_slice());
        let mut output_ref = input;
        ntt_naive(output_ref.as_mut_slice());
        assert_eq!(output, output_ref);
    }


    #[test]
    fn test_ntt_32() {
        let size = 32;
        let input = (0..size).map(Field::from).collect::<Vec<_>>();
        let mut output = input.clone();
        ntt_32(output.as_mut_slice());
        let mut output_ref = input;
        ntt_naive(output_ref.as_mut_slice());
        assert_eq!(output, output_ref);
    }


    #[test]
    fn test_ntt_64() {
        let size = 64;
        let input = (0..size).map(Field::from).collect::<Vec<_>>();
        let mut output = input.clone();
        ntt_64(output.as_mut_slice());
        let mut output_ref = input;
        ntt_naive(output_ref.as_mut_slice());
        assert_eq!(output, output_ref);
    }


    #[test]
    fn test_ntt_128() {
        let size = 128;
        let input = (0..size).map(Field::from).collect::<Vec<_>>();
        let mut output = input.clone();
        ntt_128(output.as_mut_slice());
        let mut output_ref = input;
        ntt_naive(output_ref.as_mut_slice());
        assert_eq!(output, output_ref);
    }

}
